-- 
-- Roll No: 58
-- Name: SWAFWANA SHERI K P
-- Program: Sample program 2
-- 


--
-- Table structure for table bookissues
--

create table bookissues(bookid int,studentid int,issue_date date,return_date date,fine decimal(5,2 )default 0.00);
alter table bookissues add constraint bookissues_pkey primary key(bookid,studentid);
alter table bookissues add constraint bookissues_fkey_bookid foreign key(bookid) references books(bookid);
alter table bookissues add constraint bookissues_fkey_studentid foreign key(studentid) referenc
es students(studentid);



--
-- Table structure for table students
--
alter table students drop course;
alter table students add dno int;
alter table students add constraint students_fkey_dno foreign key(dno) references departments(dno);



--
-- Table structure for table departments
--
create table departments(dno int primary key,dname varchar(50) not null);


--
-- Dumping data for table departments
--
insert into departments values(1,'MCA');



--
-- SQl Query Statements
--
--Q7. List all books issued with student details (include attributes studentid, name, bookid, title)
select students.id,students.sname,books.bookid,books.title from bookissues join students on bookissues.studentid=students.id join books on bookissues.bookid=books.bookid;
--Q8. Show all students along with their department names (include attributes studentid, name, dname)
select students.id,students.sname,departments.dname from students join departments on students.dno = departments.dno;
--Q9. List students who have issued books along with their department (include attributes studentid, name, dname, bookid, title)
select students.id,students.sname,departments.dname,bookissues.bookid,books.title from
bookissues join students on bookissues.studentid=students.id join books on bookissues.bookid=books.bookid join departments on students.dno=departments.dno;
--Q10. Find books that have never been issued (include attributes bookid, title)
 select books.bookid,books.title from books left join bookissues on books.bookid=bookissues.bookid where bookissues.bookid is NULL;
--Q11. Get students who have not issued any book (include attributes studentid, name)
select students.id,students.sname from students left join bookissues on students.id=bookissues.studentid;
--Q12. Find students who have issued books but not returned them yet (include attributes studentid, name)
select students.id, students.sname from students join bookissues on students.id=bookissues.studentid where bookissues.return_date is NULL;
--Q13. List the books whose price greater than rupees 600 (include attributes bookid, title)
select bookid,title from books where price>%s;


